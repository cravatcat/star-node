# 18.1 路由基础

## 1. 前端路由原理

前端路由的核心在于：**改变 URL 而不重新请求页面，同时渲染对应的组件。**

### 1.1 Hash 模式

- **原理**：利用 URL 中的 hash (`#`) 变化。
- **特点**：Hash 值的变化不会触发 HTTP 请求，但会触发 `hashchange` 事件。
- **兼容性**：好，兼容老旧浏览器。

```javascript
// 模拟实现
window.addEventListener('hashchange', () => {
  const hash = window.location.hash.slice(1);
  console.log('Current hash:', hash);
  // 根据 hash 渲染不同内容
  render(hash);
});
```

### 1.2 History 模式

- **原理**：利用 HTML5 History API (`pushState`, `replaceState`) 和 `popstate` 事件。
- **特点**：URL 更美观（没有 `#`），但需要服务器配置支持（防止刷新 404）。

```javascript
// 改变 URL
history.pushState(state, title, '/new-path');

// 监听后退/前进
window.addEventListener('popstate', (event) => {
  console.log('Location:', document.location.pathname);
});
```

## 2. BrowserRouter vs HashRouter

| 特性 | BrowserRouter | HashRouter |
| :--- | :--- | :--- |
| **URL 格式** | `/path/to/route` | `/#/path/to/route` |
| **底层 API** | History API | `window.location.hash` |
| **服务器配置** | **需要** (所有路径指向 index.html) | 不需要 |
| **SEO** | 较好 | 较差 (搜索引擎可能忽略 hash) |
| **使用场景** | 生产环境，SSR | 静态文件服务器，老旧项目 |

## 3. 常见问题

- **为什么 History 模式刷新会 404？**
  - 因为浏览器会真的向服务器请求 `/user/123` 这个资源，而服务器上并没有这个文件。需要配置服务器（如 Nginx）将所有请求 fallback 到 `index.html`。

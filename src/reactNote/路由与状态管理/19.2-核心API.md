# 19.2 核心 API


## 1. set 函数

用于更新状态。

- **部分更新 (Merge)**：默认行为，自动合并第一层属性。
  ```javascript
  set({ count: 1 }) // 类似于 this.setState
  ```
- **函数式更新**：依赖前一个状态。
  ```javascript
  set(state => ({ count: state.count + 1 }))
  ```
- **替换更新 (Replace)**：第二个参数设为 `true`，完全替换 state。
  ```javascript
  set({ count: 1 }, true) // 此时 state 只有 count，其他属性丢失
  ```

## 2. get 函数

用于在 actions 中获取当前状态（非响应式）。

```javascript
const useStore = create((set, get) => ({
  count: 0,
  action: () => {
    const count = get().count; // 获取最新值
    // ...
  }
}))
```

## 3. subscribe

订阅状态变化（通常用于副作用，如日志、持久化）。

```javascript
const useStore = create(...)

// 订阅整个 store
const unsub = useStore.subscribe((state, prevState) => {
  console.log('State changed:', state);
})

// 取消订阅
unsub();
```

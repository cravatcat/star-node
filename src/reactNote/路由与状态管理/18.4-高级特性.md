# 18.4 高级特性


## 1. 嵌套路由 (Nested Routes)

React Router v6 的杀手级特性，通过 `<Outlet>` 渲染子路由。

```tsx
// 配置
<Route path="dashboard" element={<Dashboard />}>
  <Route path="settings" element={<Settings />} />
  <Route path="profile" element={<Profile />} />
</Route>

// Dashboard 组件
import { Outlet } from 'react-router-dom';
function Dashboard() {
  return (
    <div>
      <h1>Dashboard</h1>
      <Outlet /> {/* 子路由渲染在这里 */}
    </div>
  );
}
```

## 2. 路由守卫 (Route Guards)

在 v6 中，推荐使用**包装组件**来实现守卫。

```tsx
function ProtectedRoute({ children }) {
  const user = useUser();
  if (!user) {
    return <Navigate to="/login" replace />;
  }
  return children;
}

// 使用
<Route path="/admin" element={
  <ProtectedRoute>
    <AdminPage />
  </ProtectedRoute>
} />
```

## 3. 懒加载路由 (Lazy Loading)

结合 `React.lazy` 和 `Suspense`。

```tsx
const About = React.lazy(() => import('./About'));

<Route path="about" element={
  <React.Suspense fallback={<div>Loading...</div>}>
    <About />
  </React.Suspense>
} />
```

## 4. 路由过渡动画

使用 `framer-motion`。

```tsx
import { useLocation } from 'react-router-dom';
import { AnimatePresence, motion } from 'framer-motion';

const location = useLocation();

<AnimatePresence mode="wait">
  <Routes location={location} key={location.pathname}>
    <Route path="/" element={
      <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }}>
        <Home />
      </motion.div>
    } />
  </Routes>
</AnimatePresence>
```

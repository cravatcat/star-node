# 12.6 useClickOutside

## 1. 实现思路

检测元素外部的点击事件，常用于关闭 Modal 或 Dropdown。

## 2. 代码实现

```typescript
import { useEffect, useRef } from 'react';

function useClickOutside(
  handler: (event: MouseEvent | TouchEvent) => void
) {
  const ref = useRef<HTMLDivElement>(null);

  useEffect(() => {
    const listener = (event: MouseEvent | TouchEvent) => {
      if (!ref.current || ref.current.contains(event.target as Node)) {
        return;
      }
      handler(event);
    };

    document.addEventListener('mousedown', listener);
    document.addEventListener('touchstart', listener);

    return () => {
      document.removeEventListener('mousedown', listener);
      document.removeEventListener('touchstart', listener);
    };
  }, [handler]);

  return ref;
}

export default useClickOutside;
```

## 3. 使用示例

```tsx
const ref = useClickOutside(() => setIsOpen(false));
return <div ref={ref}>Menu</div>;
```

## 4. 常见问题

- **事件冒泡**：注意 click 事件可能被阻止冒泡，这里监听的是 document 上的事件。

# 12.2 useThrottle

## 1. 实现思路

节流 Hook，限制值的更新频率。

## 2. 代码实现

```typescript
import { useState, useEffect, useRef } from 'react';

function useThrottle<T>(value: T, interval: number = 500): T {
  const [throttledValue, setThrottledValue] = useState(value);
  const lastUpdated = useRef<number>(Date.now());

  useEffect(() => {
    const now = Date.now();
    if (now - lastUpdated.current >= interval) {
      setThrottledValue(value);
      lastUpdated.current = now;
    } else {
      const id = setTimeout(() => {
        setThrottledValue(value);
        lastUpdated.current = Date.now();
      }, interval - (now - lastUpdated.current));

      return () => clearTimeout(id);
    }
  }, [value, interval]);

  return throttledValue;
}

export default useThrottle;
```

## 3. 使用示例

```tsx
const throttledScroll = useThrottle(scrollPosition, 100);
```

## 4. 常见问题

- **vs Debounce**：Throttle 保证在规定时间内至少执行一次，而 Debounce 可能一直推迟。

# 1.2 ç»„ä»¶åŒ–æ€æƒ³

## 1. æ¦‚å¿µè®²è§£

**ç»„ä»¶åŒ–**æ˜¯å°†å¤æ‚çš„ UI ç•Œé¢æ‹†åˆ†æˆå¤šä¸ªç‹¬ç«‹ã€å¯å¤ç”¨ã€èŒè´£å•ä¸€çš„å°å‹å•å…ƒï¼ˆç»„ä»¶ï¼‰ã€‚å°±åƒæ­ç§¯æœ¨ä¸€æ ·ï¼Œé€šè¿‡ç»„åˆè¿™äº›å°ç»„ä»¶æ¥æ„å»ºå¤§å‹åº”ç”¨ã€‚

åœ¨ React ä¸­ï¼Œç»„ä»¶æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª JavaScript å‡½æ•°æˆ–ç±»ï¼Œå®ƒæ¥æ”¶ä»»æ„çš„è¾“å…¥ï¼ˆç§°ä¸º `props`ï¼‰å¹¶è¿”å›ç”¨äºæè¿°é¡µé¢å±•ç¤ºå†…å®¹çš„ React å…ƒç´ ã€‚

### ä¸ºä»€ä¹ˆéœ€è¦ç»„ä»¶åŒ–ï¼Ÿ

* **å¤ç”¨æ€§**ï¼šé€šç”¨çš„ UIï¼ˆå¦‚æŒ‰é’®ã€è¾“å…¥æ¡†ï¼‰å¯ä»¥åœ¨ä¸åŒåœ°æ–¹é‡å¤ä½¿ç”¨ã€‚
* **å¯ç»´æŠ¤æ€§**ï¼šæ¯ä¸ªç»„ä»¶èŒè´£å•ä¸€ï¼Œå‡ºäº†é—®é¢˜å®¹æ˜“å®šä½å’Œä¿®å¤ã€‚
* **åä½œæ€§**ï¼šä¸åŒå¼€å‘è€…å¯ä»¥å¹¶è¡Œå¼€å‘ä¸åŒçš„ç»„ä»¶ã€‚

## 2. å®ç°æ€è·¯ï¼šè®¾è®¡åŸåˆ™

åœ¨è®¾è®¡ React ç»„ä»¶æ—¶ï¼Œé€šå¸¸éµå¾ªä»¥ä¸‹æ ¸å¿ƒåŸåˆ™ï¼š

### 2.1 å•ä¸€èŒè´£åŸåˆ™ (Single Responsibility Principle)

ä¸€ä¸ªç»„ä»¶åº”è¯¥åªåšä¸€ä»¶äº‹ã€‚å¦‚æœä¸€ä¸ªç»„ä»¶çš„åŠŸèƒ½å˜å¾—è¿‡äºå¤æ‚ï¼Œå°±åº”è¯¥å°†å…¶æ‹†åˆ†æˆæ›´å°çš„å­ç»„ä»¶ã€‚

* **UI ç»„ä»¶ (Dumb/Presentational)**: åªè´Ÿè´£æ¸²æŸ“ï¼Œä¸å¤„ç†é€»è¾‘ï¼Œæ•°æ®ç”± props ä¼ å…¥ã€‚
* **å®¹å™¨ç»„ä»¶ (Smart/Container)**: è´Ÿè´£è·å–æ•°æ®å’Œå¤„ç†é€»è¾‘ï¼Œå°†æ•°æ®ä¼ é€’ç»™ UI ç»„ä»¶ã€‚

### 2.2 ç»„åˆä¼˜äºç»§æ‰¿ (Composition over Inheritance)

React å¼ºçƒˆæ¨èä½¿ç”¨â€œç»„åˆâ€æ¥å®ç°ä»£ç å¤ç”¨ï¼Œè€Œä¸æ˜¯â€œç»§æ‰¿â€ã€‚

* **åŒ…å«å…³ç³»**ï¼šé€šè¿‡ `props.children` å°†å­ç»„ä»¶ä¼ é€’ç»™çˆ¶ç»„ä»¶ï¼ˆå¦‚ Dialog, Sidebarï¼‰ã€‚
* **ç‰¹ä¾‹å…³ç³»**ï¼šé€šè¿‡ props é…ç½®åŸºç¡€ç»„ä»¶æ¥æ„å»ºç‰¹æ®Šç»„ä»¶ï¼ˆå¦‚ `Button` -> `DangerButton`ï¼‰ã€‚

## 3. æ¨¡æ‹Ÿå®ç°ï¼šComponent åŸºç±»

ä¸ºäº†ç†è§£ React ç±»ç»„ä»¶çš„å·¥ä½œåŸç†ï¼Œæˆ‘ä»¬å¯ä»¥æ¨¡æ‹Ÿä¸€ä¸ªæœ€åŸºç¡€çš„ `Component` ç±»ã€‚å®ƒæ ¸å¿ƒçš„åŠŸèƒ½æ˜¯ç®¡ç† `props` å’Œ `state`ï¼Œå¹¶åœ¨ `setState` æ—¶è§¦å‘æ›´æ–°ã€‚

```javascript
// 1. æ¨¡æ‹Ÿ React.Component åŸºç±»
class Component {
  constructor(props) {
    this.props = props;
    this.state = {}; // åˆå§‹åŒ–ç©ºçŠ¶æ€
  }

  /**
   * æ›´æ–°çŠ¶æ€å¹¶è§¦å‘é‡æ¸²æŸ“
   * @param {object|function} partialState æ–°çš„éƒ¨åˆ†çŠ¶æ€
   */
  setState(partialState) {
    // 1. åˆå¹¶çŠ¶æ€ (ç®€åŒ–ç‰ˆï¼Œä¸è€ƒè™‘å‡½æ•°å¼æ›´æ–°å’Œå¼‚æ­¥é˜Ÿåˆ—)
    this.state = {
      ...this.state,
      ...partialState
    };

    // 2. è§¦å‘æ›´æ–°
    // åœ¨çœŸå® React ä¸­ï¼Œè¿™é‡Œä¼šè§¦å‘åè°ƒè¿‡ç¨‹ (Reconciliation)
    console.log('âš¡ï¸ State updated, triggering render...');
    this._render();
  }

  // æ¨¡æ‹Ÿæ¸²æŸ“æ–¹æ³•ï¼Œå­ç±»éœ€è¦è¦†ç›–
  render() {
    throw new Error('Component must implement render method');
  }

  // å†…éƒ¨æ¸²æŸ“è¾…åŠ©æ–¹æ³• (ä»…ç”¨äºæ¨¡æ‹Ÿ)
  _render() {
    const vNode = this.render();
    console.log('ğŸ–¼ï¸ Rendered UI:', vNode);
    return vNode;
  }
}

// --- ä½¿ç”¨ç¤ºä¾‹ ---

// 2. å®šä¹‰ä¸€ä¸ªè®¡æ•°å™¨ç»„ä»¶
class Counter extends Component {
  constructor(props) {
    super(props);
    // åˆå§‹åŒ– state
    this.state = { count: 0 };
  }

  increment() {
    // ä¿®æ”¹ state
    this.setState({ count: this.state.count + 1 });
  }

  render() {
    // è¿”å›æè¿° UI çš„å­—ç¬¦ä¸² (æ¨¡æ‹Ÿè™šæ‹Ÿ DOM)
    return `<div>Count: ${this.state.count} (Theme: ${this.props.theme})</div>`;
  }
}

// 3. è¿è¡Œæµ‹è¯•
console.log('--- Init ---');
const counter = new Counter({ theme: 'dark' }); // ä¼ å…¥ props
counter._render(); // é¦–æ¬¡æ¸²æŸ“

console.log('\n--- Action: Increment ---');
counter.increment(); // è°ƒç”¨æ–¹æ³•æ›´æ–° state
```

### è¾“å‡ºç»“æœ

```text
--- Init ---
ğŸ–¼ï¸ Rendered UI: <div>Count: 0 (Theme: dark)</div>

--- Action: Increment ---
âš¡ï¸ State updated, triggering render...
ğŸ–¼ï¸ Rendered UI: <div>Count: 1 (Theme: dark)</div>
```

## 4. å¸¸è§é—®é¢˜

### Q1: ç»„ä»¶æ‹†åˆ†çš„åŸåˆ™æ˜¯ä»€ä¹ˆï¼Ÿ

**ç­”**ï¼š

1. **å•ä¸€èŒè´£**ï¼šå¦‚æœä¸€ä¸ªç»„ä»¶éœ€è¦ç®¡ç†å¾ˆå¤šçŠ¶æ€æˆ–æ¸²æŸ“å¾ˆå¤šä¸ç›¸å…³çš„ DOMï¼Œå°±è¯¥æ‹†åˆ†ã€‚
2. **å¯å¤ç”¨æ€§**ï¼šå¦‚æœæŸéƒ¨åˆ† UI åœ¨å¤šå¤„å‡ºç°ï¼Œåº”æå–ä¸ºé€šç”¨ç»„ä»¶ã€‚
3. **æ€§èƒ½ä¼˜åŒ–**ï¼šå°†é¢‘ç¹æ›´æ–°çš„éƒ¨åˆ†æ‹†åˆ†ä¸ºç‹¬ç«‹ç»„ä»¶ï¼Œé¿å…çˆ¶ç»„ä»¶æ›´æ–°å¯¼è‡´æ•´ä¸ªå¤§ç»„ä»¶é‡æ¸²æŸ“ã€‚

### Q2: Props å’Œ State çš„åŒºåˆ«ï¼Ÿ

**ç­”**ï¼š

| ç‰¹æ€§ | Props (å±æ€§) | State (çŠ¶æ€) |
| :--- | :--- | :--- |
| **æ¥æº** | çˆ¶ç»„ä»¶ä¼ å…¥ | ç»„ä»¶è‡ªèº«å®šä¹‰ |
| **ä¿®æ”¹æƒé™** | **åªè¯»** (ä¸å¯åœ¨ç»„ä»¶å†…ä¿®æ”¹) | **å¯å˜** (é€šè¿‡ setState ä¿®æ”¹) |
| **ä½œç”¨** | ç»„ä»¶é—´é€šä¿¡/é…ç½® | ç»„ä»¶å†…éƒ¨æ•°æ®æµè½¬/äº¤äº’ |
| **å¯¹åº”å…³ç³»** | å‡½æ•°å‚æ•° | å‡½æ•°å†…éƒ¨å˜é‡ |

### Q3: ä»€ä¹ˆæ˜¯å—æ§ç»„ä»¶ä¸éå—æ§ç»„ä»¶ï¼Ÿ

* **å—æ§ç»„ä»¶**ï¼šè¡¨å•æ•°æ®ç”± React ç»„ä»¶çš„ `state` ç®¡ç†ï¼ˆæ¨èï¼‰ã€‚
* **éå—æ§ç»„ä»¶**ï¼šè¡¨å•æ•°æ®ç”± DOM è‡ªèº«ç®¡ç†ï¼Œé€šè¿‡ `ref` è·å–ã€‚
*(æ³¨ï¼šè¿™é€šå¸¸æ˜¯åç»­ç« èŠ‚çš„é‡ç‚¹ï¼Œä½†ä¸ç»„ä»¶åŒ–æ€æƒ³ç´§å¯†ç›¸å…³)*

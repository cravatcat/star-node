# 12.3 useInterval

## 1. 实现思路

声明式的 setInterval，解决闭包陷阱。

## 2. 代码实现

```typescript
import { useEffect, useRef } from 'react';

function useInterval(callback: () => void, delay: number | null) {
  const savedCallback = useRef(callback);

  // 记住最新的 callback
  useEffect(() => {
    savedCallback.current = callback;
  }, [callback]);

  // 设置 interval
  useEffect(() => {
    if (delay !== null) {
      const id = setInterval(() => savedCallback.current(), delay);
      return () => clearInterval(id);
    }
  }, [delay]);
}

export default useInterval;
```

## 3. 使用示例

```tsx
useInterval(() => {
  setCount(count + 1);
}, 1000);
```

## 4. 常见问题

- **暂停**：传入 `null` 作为 delay 可以暂停定时器。
- **闭包陷阱**：通过 useRef 保存最新的 callback，确保定时器执行时能访问最新状态。
